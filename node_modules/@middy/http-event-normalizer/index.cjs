"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(module, "exports", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const httpEventNormalizerMiddleware = ()=>{
    const httpEventNormalizerMiddlewareBefore = async (request)=>{
        const { event } = request;
        const version = pickVersion(event);
        const isHttpEvent = isVersionHttpEvent[version]?.(event);
        if (!isHttpEvent) {
            throw new Error('[http-event-normalizer] Unknown http event format');
        }
        if (version === '1.0') {
            event.multiValueQueryStringParameters ??= {};
        } else if (version === 'vpc') {
            event.queryStringParameters = event.query_string_parameters;
            event.isBase64Encoded = event.is_base64_encoded;
        }
        event.pathParameters ??= {};
        event.queryStringParameters ??= {};
    };
    return {
        before: httpEventNormalizerMiddlewareBefore
    };
};
const pickVersion = (event)=>{
    return event.version ?? (event.method ? 'vpc' : '1.0');
};
const isVersionHttpEvent = {
    '1.0': (event)=>typeof event.httpMethod !== 'undefined',
    '2.0': (event)=>typeof event.requestContext.http.method !== 'undefined',
    vpc: (event)=>typeof event.method !== 'undefined'
};
const _default = httpEventNormalizerMiddleware;

